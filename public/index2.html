<!DOCTYPE html>
<html>
<head>
    <title>Leaflet.heat demo</title>
    <link rel="stylesheet" href="dist/leaflet.css" />
    <script src="dist/leaflet.js"></script>
    <style>
        * {
            font-family: 'Roboto', sans-serif;
        }

        @keyframes click-wave {
            0% {
                height: 40px;
                width: 40px;
                opacity: 0.35;
                position: relative;
            }

            100% {
                height: 200px;
                width: 200px;
                margin-left: -80px;
                margin-top: -80px;
                opacity: 0;
            }
        }

        .option-input {
            -webkit-appearance: none;
            -moz-appearance: none;
            -ms-appearance: none;
            -o-appearance: none;
            appearance: none;
            position: relative;
            top: 13.33333px;
            right: 0;
            bottom: 0;
            left: 0;
            height: 40px;
            width: 40px;
            transition: all 0.15s ease-out 0s;
            background: #cbd1d8;
            border: none;
            color: #fff;
            cursor: pointer;
            display: inline-block;
            margin-right: 0.5rem;
            outline: none;
            position: relative;
            z-index: 1000;
        }

            .option-input:hover {
                background: #9faab7;
            }

            .option-input:checked {
                background: #40e0d0;
            }

                .option-input:checked::before {
                    height: 40px;
                    width: 40px;
                    position: absolute;
                    content: '✔';
                    display: inline-block;
                    font-size: 26.66667px;
                    text-align: center;
                    line-height: 40px;
                }

                .option-input:checked::after {
                    -webkit-animation: click-wave 0.65s;
                    -moz-animation: click-wave 0.65s;
                    animation: click-wave 0.65s;
                    background: #40e0d0;
                    content: '';
                    display: block;
                    position: relative;
                    z-index: 100;
                }

            .option-input.radio {
                border-radius: 50%;
            }

                .option-input.radio::after {
                    border-radius: 50%;
                }



            body label {
                display: block;
                line-height: 40px;
            }

        /*-------*/
        #map {
            width: 800px;
            height: 600px;
        }

        body {
            font: 16px/1.4 "Helvetica Neue", Arial, sans-serif;
        }

        .ghbtns {
            position: relative;
            top: 4px;
            margin-left: 5px;
        }

        a {
            color: #0077ff;
        }
        .gas{
            width: 200px;
            padding:5px;
            float:left;
            border:1px solid #ddd;
        }
        #play {
            padding: 5px 15px;
            background-color: #1fa3de !important;
            border-color: #1fa3de !important;
            color:white;
        }
    </style>

    <script src="https://code.jquery.com/jquery-1.12.4.min.js"
            integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ="
            crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/8.5.1/nouislider.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/8.5.1/nouislider.min.js"></script>

</head>
<body>

    <div id="map" style="width:1500px; height:600px;"></div>
    <div id="ss" style="font-family:Calibri;font-size:22px; height:35px;width:200px;margin:0 auto;padding:5px; border:1px solid #ddd;text-align:center;">
        <button id="play" onclick="javascript:playMap();">Play ></button> <span id="year"></span></div>

    <!-- <script src="../node_modules/simpleheat/simpleheat.js"></script>
    <script src="../src/HeatLayer.js"></script> -->

    <script src="dist/leaflet-heat.js"></script>
    <script src="dist/myData.js"></script>
    <script>
        //--------- Creating array from json
        var addressPoints = [];
        for (var i in myData) {
            var item = myData[i];
            addressPoints.push([
                item.Location.Latitude,
                item.Location.Longitude,
                item.NormConcentration,
                item.GasID,
                item.orbitYear
            ]);
        }

    </script>

    <!--<div id="slider" style="top: 0px; right: 1px; margin: 10px 25px;"></div>
    <div style="margin-right: auto; margin-left: auto; width: 90%; margin-bottom: 10px; text-align: center;">
        <input type="number" min='1' max='2019' id="input-number-min">
        <input type="number" min='2' max='35676000' id="input-number-max">
    </div>-->
    <input type="radio" id="Ozone" name="gas" class="gas" value="O3" checked onclick="javascript: createMap('O3');">Ozone<br>
    <input type="radio" id="CH4" name="gas" class="gas" value="CH4" onclick="javascript: createMap('CH4');">Methane gas<br>
    <input type="radio" id="CO2" name="gas" class="gas" value="CO2" onclick="javascript: createMap('CO2');">Carbon Dioxide<br>

    <script type="text/javascript">
        var currentYear = 2004;
        var subArray = [];
        var map;
        var timer;
        var lgroup;
        var heat;
        jQuery(document).ready(function () {
            jQuery(".gas").change(function (e) {
                //debugger;
                //addressPoints.filter(gases,e.data);
                //addressPoints.filter(point => point[1] == e.data);
            });
            map = L.map('map', {
                center: [56.1304, -108.3468],
                zoom: 3,
                continuousWorld: true
            });  //.setView([56.1304, -108.3468], 5);
            var tiles = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',
            }).addTo(map);
            subArray = addressPoints.filter(point => point[3] == 'O3');
            heat = L.heatLayer(subArray, {
                "id": 'layer1',
                "gradient": { 0.4: 'yellow', 0.5: 'red', .6: 'blue' },
                "radius": 70,
                "blur": 10,
            });//.addTo(map)
            map.addLayer(heat);
            //var animationControl = L.control.animation('control',{
            //    animationControl: true,
            //    playbackSpeed: 1000,
            //    playbackSpeeds: [100, 500, 1000, 10000, 100000],
            //    stepWidth: 1000
            //}).addTo(map);

        });
        function playMap() {
            timer = setInterval(callMap, 1000);
        }
        function callMap() {
            debugger;
            jQuery('#year').text(currentYear);
            createMap('O3', currentYear); //jQuery(".gas input[type='radio']:checked").val()
            currentYear++;
            if (currentYear >= 2020) {
                //window.clearInterval(timer);
                currentYear = 2004;
            }
        }

        function createMap(gas, year) {
            debugger;
            if ((year !== null && year !== undefined) && year !== '') {
                subArray = addressPoints.filter(point => point[3] == gas && point[4] == year);
            } else {
                subArray = addressPoints.filter(point => point[3] == gas);
            }
            //--- Remove existing Map if exits
            if (typeof map !== 'undefined') {
                map.removeLayer(heat);
            }
            heat = L.heatLayer(subArray, {
                "id": 'layer1',
                "gradient": { 0.4: 'yellow', 0.5: 'red', .6: 'blue' },
                "radius": 70,
                "blur": 10,
            });//.addTo(map)
            map.addLayer(heat);
        }
        function addLayer(gas, year) {
            if (year !== null && year !== '') {
                subArray = addressPoints.filter(point => point[3] == gas && point[4] == year);
            } else {
                subArray = addressPoints.filter(point => point[3] == gas);
            }
            //--- Remove existing Map if exits
            if (typeof map !== 'undefined') {
                debugger;
                map.remove(heat);
            }
            heat = L.heatLayer(subArray, {
                "id": 'layer1',
                "gradient": { 0.4: 'yellow', 0.5: 'red', .6: 'blue' },
                "radius": 70,
                "blur": 10,
            });//.addTo(map)
            map.addLayer(heat);
        }
    </script>
</body>
</html>